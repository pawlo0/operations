<div class = "span9">

<h2><%= @equipment.name %> <small>Equipamento nº<%= @equipment.num_id %><span class="pull-right"><%= render 'arrows' %></span></small></h2>

<hr>
<div class="row">
  <div class="span4">
    <p>Marca: <%= @equipment.manufacturer %></p>
    <p>Modelo: <%= @equipment.model %></p>
    <p>Número de série: <%= @equipment.serial %></p>
    <p>Data fabrico: <%= @equipment.manuf_date %></p>
    <p>Data compra: <%= @equipment.buy_date %></p>    
  
  </div>

  <div class="span4">
    <p>Fábrica: <%= @equipment.plant.name if @equipment.plant %></p>
    <p>Função: <%= @equipment.function %></p>
    <p>Localização: <%= @equipment.location %></p>
    <p>Contacto de manutenção: <%= @equipment.maintenance_contact %></p>
    <p>Observações: <%= @equipment.obs %></p>
  </div>
</div>
<hr>
<div class="row">
  <div class="span6">
    <%= form_tag hour_register_interventions_path(:id => @equipment.id), multipart: true, :class => 'form-horizontal' do %>
    <% @intercept = 0 unless @intercept.is_a?(Numeric) %>
    <p>Horas actuais estimadas: <%= number_field_tag :hours, @intercept.round(0) %> <%= submit_tag "Registar horas" %>
    <% end %></p>
  </div>
</div>


<% if @maintasks.count > 0 %>
<hr>
<h3>Plano de manutenção <small>Equipamento nº<%= @equipment.num_id %></small></h3>

<table class="table table-hover">
  <tr>
    <th>Tarefa</th>
    <th>Periodicidade</th>
  </tr>
  <% @maintasks.each do |maintask| %>
    <tr>
      <td><%= link_to truncate(maintask.task, :length => 100), equipment_maintask_path(@equipment, maintask) %></td>
      <td><p> Cada <%= maintask.period %> <%= maintask.unit %></p></td>
      <td><%= link_to 'Intervenção', new_equipment_intervention_path(@equipment, 
      :period => maintask.period, 
      :unit => maintask.unit, 
      :parts => maintask.parts, 
      :intervention_type => InterventionType.where("name LIKE ?", "%prevent%").first.id), :class => 'btn btn-default' %></td>
    </tr>
  <% end %>
</table>
<% end %>

<% if @interventions.count > 0 %>
<hr>
<h3>Lista de Intervenções <small>Equipamento nº<%= @equipment.num_id %></small></h3>

<table class="table table-hover">
  <tr>
    <th><%= sort_link @search, :day, 'Data Intervenção' %></th>
    <th>Descrição</th>
    <th>Horas</th>
  </tr>
  <% @interventions.each do |intervention| %>
    <tr>
    <td><%= link_to intervention.day, equipment_intervention_path(@equipment, intervention) %></td>
    <td><%= link_to truncate(intervention.description, :length => 100), equipment_intervention_path(@equipment, intervention) %></td>
    <td><%= link_to intervention.eq_hours, equipment_intervention_path(@equipment, intervention) %></td>
    <td><%= link_to 'Editar', edit_equipment_intervention_path(@equipment, intervention), :class => 'btn btn-default' %></td>
    </tr>
  <% end %>
</table>
<% end %>

</div><!-- span9 -->

<div class="span3">
  <%= render 'side' %>
</div>


